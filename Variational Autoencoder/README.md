# Variational Autoencoders
Generative Models are subset of machine learning where our task is to make a model which can *generate images*, not same but similar to our dataset on which model is trained. VAE is one of the most successful approch towards the problem of generating images similar to dataset.

Variational autoencoders are **Generative Models** where there task is to make a continuous latent variable space from where we can sample random points and generate new images similar to dataset. 
Simple autoencoders are used for encoding the data(say images) in some lower dimensional space where as in VAE's, a continuous distribution of latent variables is generated with given data from which we can sample datapoints in terms of latent variables and generate new images.
![encoders](https://www.renom.jp/notebooks/tutorial/generative-model/VAE/fig4.png)
As illustrated in image above, we encode **x** in **z** (generally z is lower dimensional than x) and than decode this **z** to **x'** in case of autoencoders. Here goal is generate **x'** as similar as **x**. But in case of variational autoencoder, we use our encoder network to output **mu** and **sigma**(mean and std for gaussian distributions of different latent variable dimensions). After having generated distribution parameters of latent variables, we sample random points from generated distribution and then decoder model comes into action. The decoder network constructs an image for given latent variable, after which we can use loss function to optimize the parameters.</br>

### Difference between Variational Autoencoder(VAE) and Generative Adversarial Networks(GAN)

The basic difference difference comes in terms of *Explicit & Implicit density functions*. GAN works on principle of game theory. The two players are Generator and Discriminator networks. Generator is a deep neural network whose task is to generate images that are indistinguishable from the images sampled from real dataset. whereas discriminator tries to panalize fake images(that are coming from generator network rather than original dataset).
![GAN](https://skymind.ai/images/wiki/GANs.png)
As described, task in GAN is not to pridict any probability distribution. Rather the task is to sample images from generative network that are similar to images in dataset. Hence here our model is learning an **Implicit Density Function** in terms of parameters of generative network.</p>
Task of variational autoencoder is somewhat different. VAE take the real image from dataset as input and tries to find the hidden probability density function in terms of mean and variance(assuming latent code to be gaussian distributed). Hence in VAE we are predicting an **Explicit Density Function** in terms of mean and variance as shown in figure below.
![VAE](https://i.imgur.com/ZN6MyTx.png)

### Problem of Intractability

To visualize the problem of intractability, we may use distribution of digits in MNIST dataset as shown below.
<img src="https://cdn-images-1.medium.com/max/975/1*-i8cp3ry4XS-05OWPAJLPg.png" width="500"></br>
As we want our model to be able to generate images that lie somewhere inbetween different classes of digits, we may face problem of Intractability. If the space has discontinuities (eg. gaps between clusters) and you sample/generate a variation from there, the decoder will simply generate an unrealistic output, because the decoder has no idea how to deal with that region of the latent space.  We can thus say that q(z|x) may not be continuous between different clusters and that will lead to intractable function.</br>
<img src="data:image/png;base64,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"> </br>


